Quick triage of the two regressions you just caught
Issue	Why it’s still happening	Fast fix
Date saved as 2025-04-30 when picker shows 05-01	In JournalEntryForm.tsx we’re still doing format(new Date(journalData.date),'yyyy-MM-dd'). Creating a Date() object forces the browser to interpret the string in local TZ → UTC, so anything picked after GMT-0 midnight shifts back a day for US users.	Never instantiate a Date for data we already have in YYYY-MM-DD form.
ts<br>// before submit<br>const formattedDate = journalData.date; // raw value from <input type="date"> is already correct<br>
Remove the format/new Date calls in create, update, submit-for-approval and reverse flows.
Able to delete attachment while editing	Backend guard is correct (['draft','pending_approval']) but the delete route still passes if the client didn’t send a status in the body. The helper journalEntryById(id) returns the row, row.status comes back lower-case, while our allow-list compare was mixed-case in one place.	1. Normalize on lower-case everywhere:
const status = journalEntry.status.toLowerCase();
2. Add an early return res.status(403) if status ∉ ['draft','pending_approval'].
3. Frontend: keep the button hidden for posted/voided, but add a fallback disable check so a crafted request can’t slip through the UI.

Exact patch steps
Frontend — JournalEntryForm  / JournalEntryDetail

diff
Copy
Edit
- const formattedDate = format(new Date(journalData.date), 'yyyy-MM-dd');
- date: formattedDate,
+ date: journalData.date,     // already YYYY-MM-DD from <input type="date">
Do the same anywhere we call format(new Date(...)).

Backend — journalEntryRoutes.ts delete/upload endpoints

diff
Copy
Edit
- const allowedStatuses = ['draft', 'pending_approval'];
- if (!allowedStatuses.includes(journalEntry.status)) {
+ const status = (journalEntry.status ?? '').toLowerCase();
+ if (!['draft', 'pending_approval'].includes(status)) {
      return res.status(403).json({ error: 'Files can only be changed on draft or pending entries' });
  }
Backend storage helpers
Strip any lingering format(new Date()) conversions—date column is already DATE, so just persist the string.

Tests

Update the happy-path create test to assert the date you post is the exact date you fetch (expect(res.body.date).toBe('2025-05-01')).

Add a negative test: attempt DELETE /files/:id on a posted entry should return 403.

Run quality gate

bash
Copy
Edit
npx eslint . --ext .ts,.tsx --fix
npx jest --runInBand --detectOpenHandles