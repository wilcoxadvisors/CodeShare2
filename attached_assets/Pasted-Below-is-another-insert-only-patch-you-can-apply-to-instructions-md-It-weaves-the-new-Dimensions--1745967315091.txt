Below is another insert-only patch you can apply to instructions.md.
It weaves the new Dimensions + Smart Events concepts and the extended AI feature set into the existing roadmap, without deleting any prior text.

0. Quick index of where to paste

#	Paste after heading	Why
A	“Phase B: Core Accounting Module (IN PROGRESS)”	Introduce Dimensions & Smart Events backlog
B	“Phase F: AI/ML & Predictive Forecasting”	Capture new AI/automation pillars
C	“General Guidelines for Agent → Prioritize”	Remind agents to consider Dimensions hooks
D	Very bottom (after Rolling Changelog)	Add glossary appendix for future reference
Copy each code-block as-is into the indicated spot.

A. ▸ Phase B patch — immediately after the bullet list for Task B.2 “General Ledger / Journal Entries”
yaml
Copy
Edit
---

🔹 **Task B.4 – Dimensions & Smart Events (BACKLOG, SPECS READY)**  
   *Objective*: replicate Sage Intacct-style multi-dimensional tagging and
   event-driven automation without expanding the CoA.

   **Scope of MVP**

   1. **Dimensions Framework**  
      • Core tables (`dimensions`, `dimension_values`, `tx_dimension_link`).  
      • System dimensions: Department, Location, Class, Customer, Vendor,
        Employee, Project, Item.  
      • User-defined dimension creation UI (admin-only).  
      • Validation rules: required vs optional, active vs inactive.  

   2. **Smart Rules (validation layer)**  
      • JSON-based rule engine to block invalid dimension/GL combos.  
      • Example rule stub:  
        ```json
        { "account": "6000", "location": ["LON", "NYC"], "allow": false }
        ```

   3. **Smart Events (event layer)**  
      • Trigger types: `onCreate`, `onUpdate` for JE, AP, AR objects.  
      • Condition builder (simple expression parser).  
      • Actions: `email`, `fieldUpdate`, `webhook`.  
      • Async dispatcher queue (BullMQ).  

   4. **AI Hooks**  
      • Every Smart Event emits an **EventBridge** message (`ai.ingest.*`) so the
        ML service can learn patterns and surface anomalies in real-time.  

   **Exit Criteria**

   - Tag ≥ 90 % of new JE records with at least one dimension.  
   - Rule engine blocks invalid department-location pairs (unit tests).  
   - Example Smart Event: send Slack alert when `amount > $10k & location=INTL`.  
   - Cypress E2E: create JE → trigger event → verify webhook fired.

---
B. ▸ Phase F patch — right after the “Task F.3 Additional AI Features” list
yaml
Copy
Edit
---

🔹 **Task F.4 – AI-Powered Ledger & Copilot (SPEC DRAFTED)**  
   - **Anomaly Detection Service**  
     • Online IsolationForest scoring for every posted JE.  
     • Flags surfaced in `AIInsightsWidget` ✔ (streaming channel already done).  

   - **Sage-style Copilot MVP**  
     • `/api/ai/qna` endpoint (LLM via OpenAI - gpt-4o3).  
     • Natural-language query → SQL translation layer (pgvector + RAG over schema docs).  

   - **Auto Reconciliation Pilot**  
     • Bank feed stub (Plaid sandbox) → auto-match to JE lines.  
     • Success metric: ≥ 80 % auto-match on sample data set.  

🔹 **Task F.5 – AP/AR Automation Enhancements**  
   - Invoice OCR ingestion micro-service (Tesseract + AWS Textract fallback).  
   - Rules-based approval flow re-using Smart Events engine (see B.4).  
   - Dunning scheduler integrated with EventBridge.

🔹 **Task F.6 – Real-Time Dashboards & ML Streaming KPIs**  
   - Pre-built widgets (cash burn, AR aging, anomaly counts).  
   - Drill-down to dimension-filtered transaction lists.

(All F.4-F.6 tasks rely on the Dimensions framework from Task B.4.)

---
C. ▸ General Guidelines patch — append to the “Prioritize” paragraph
pgsql
Copy
Edit
• **Dimensions-Aware Thinking**: when creating new tables, APIs, or tests,
  always ask “does this need dimension tags or Smart Event hooks?”  Add them
  early to avoid refactors.
D. ▸ NEW Appendix – “Dimensions & Smart Events Glossary” — paste at file end, after Rolling Changelog
pgsql
Copy
Edit
---

## 📚  Appendix – Dimensions & Smart Events Glossary

| Term | Definition |
|------|------------|
| **Dimension** | Categorical attribute (e.g., Department, Location) attached to any transaction for multi-axis reporting. |
| **Smart Rule** | Validation rule that restricts which dimension combinations are allowed on specific GL accounts. |
| **Smart Event** | No-code automation: *Trigger* + *Condition* + *Action* (email, webhook, field update). |
| **AI EventBridge** | Internal pub/sub topic (`ai.ingest.*`) that streams Smart Event payloads to the ML service for continual learning. |
| **Copilot** | Chat-style assistant that answers NL questions and triggers tasks inside the app. |
| **Anomaly Score** | 0-1 value generated by IsolationForest; > 0.8 surfaces as a high-risk flag in the UI. |

(Keep this glossary alphabetised as new terms emerge.)
✔️ That’s it
These four patches slot neatly into the existing instructions.md, enriching it with:

a clear backlog item for Dimensions & Smart Events

expanded AI/automation roadmap

a reminder for every dev to think “dimension-first, event-first”

a handy glossary for future readers